@{
    ViewBag.Title = "Index";
    Layout = null;
}

@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/jqueryval")
@Scripts.Render("~/bundles/bootstrap")
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

@*<link rel="stylesheet" type="text/css" href="~/Content/datatables.min.css" />
    <link href="~/Content/responsive.datatables.min.css" rel="stylesheet" />
    <link href="~/Content/buttons.datatables.min.css" rel="stylesheet" />*@
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4-4.1.1/dt-1.10.22/b-1.6.5/datatables.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap4.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.6/css/responsive.bootstrap4.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.bootstrap4.min.css" />
<div class="container">

    <a href="/Item/Create" class="btn btn-success">Add Item</a>


    <table id="myTable" class="table table-striped table-hover table-bordered" style="width: 100%;">
        <thead>
            <tr>
                <th data-priority="1"> Item ID</th>
                <th data-priority="3"> Item Name</th>
                <th data-priority="4"> Country</th>
                <th data-priority="2"> Action</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

@*<script type="text/javascript" src="~/Scripts/datatables.min.js"></script>
    <script src="~/Scripts/responsive.datatable.min.js"></script>
    <script src="~/Scripts/buttons.datatable.min.js"></script>*@
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/bs4-4.1.1/dt-1.10.22/b-1.6.5/datatables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.6/js/dataTables.responsive.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.6/js/responsive.bootstrap4.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.bootstrap4.min.js"></script>

<script>
    $(document).ready(function () {
        var responsiveHelper_dt_basic = undefined;

        var breakpointDefinition = {
            desktop: 2066,
            tablet: 1024,
            phone: 600
        };

        $('#myTable').dataTable({
            //"sDom": '<"top">rt<"bottom"lp i><"clear">',

            responsive: {
                details: {
                    display: $.fn.dataTable.Responsive.display.childRowImmediate
                }
            },
            "stateSave": true,
            "autoWidth": true,
            "bLengthChange": false,
            "processing": true,
            "serverSide": true,
            //"order": [[1, "asc"]],
            "ajax": {
                "url": "/Item/GetAllItems",
                "type": "POST",
                "datatype": "json",
                error: function (xhr, httpStatusMessage, customErrorMessage) {
                    if (xhr.status === 410) {
                        window.location.href = customErrorMessage;
                    }
                }
            },
            "columns": [
                { "data": "id", "name": "id", "autoWidth": true },
                { "data": "Name", "name": "Name", "autoWidth": true },
                { "data": "Country", "name": "Country", "autoWidth": true },

                {
                    "data": "id", "width": "50px", "class": "Acenter", "orderable": false, "render": function (data) {
                        var detail = '<a title="Detail" href="/Item/read?id=' + data + '"><i class="fa fa-info text-primary"></i></a>&nbsp';
                        var edit = '<a title="Edit" href="/Item/update?id=' + data + '"><i class="fa fa-edit text-warning"></i></a>&nbsp';
                        var del = '<a title="Delete User Type" href="javascript:deleteById(' + data + ')"><i class="fa fa-times-circle text-danger"></i></a>';
                        var final = detail + edit + del;

                        return final;

                    }
                }
            ],
            buttons: [
                'pdf'
            ]
            //"buttons": [
            //    {
            //        extend: 'pdf',
            //        text: 'Save current page',
            //        exportOptions: {
            //            modifier: {
            //                page: 'current'
            //            }
            //        }
            //    }
            //],
        });
        oTable = $('#myTable').DataTable();
    });

    function deleteById(data) {
        var confirmation = confirm("Are you sure you want to delete item?");

        if (confirmation) {
            $.ajax({
                type: "POST",
                url: "/Item/Delete",
                data: { id: data },
                dataType: 'json',
                success: function (data) {
                    alert(data.Data);
                    if (data.Status) {
                        $('#myTable').DataTable().ajax.reload(null, false);
                    }
                }
            });
        }
    }
</script>

